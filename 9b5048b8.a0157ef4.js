(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{178:function(e,a,n){"use strict";n.r(a),n.d(a,"frontMatter",(function(){return t})),n.d(a,"rightToc",(function(){return s})),n.d(a,"default",(function(){return l}));n(51),n(24),n(19),n(20),n(52),n(0);var o=n(221);function r(){return(r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var t={id:"jda-4",title:"Creaci\xf3n de comandos",sidebar_label:"Creaci\xf3n de comandos"},s=[{value:"Introducci\xf3n",id:"introducci\xf3n",children:[]},{value:"Administrar comandos",id:"administrar-comandos",children:[]},{value:"Crear comandos",id:"crear-comandos",children:[]},{value:"Conclusi\xf3n",id:"conclusi\xf3n",children:[]}],c={rightToc:s},i="wrapper";function l(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,o,r={},t=Object.keys(e);for(o=0;o<t.length;o++)n=t[o],a.indexOf(n)>=0||(r[n]=e[n]);return r}(e,["components"]);return Object(o.b)(i,r({},c,n,{components:a,mdxType:"MDXLayout"}),Object(o.b)("ol",null,Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",r({parentName:"li"},{href:"#introducci%C3%B3n"}),"Introducci\xf3n")," - Introducci\xf3n al administrador de comandos o ",Object(o.b)("em",{parentName:"li"},"command handler"),"."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",r({parentName:"li"},{href:"#administrar-comandos"}),"Adminisitrar comandos")," - C\xf3mo administrar los comandos y tener un c\xf3digo semi-est\xe1tico que mueva todo."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",r({parentName:"li"},{href:"#crear-comandos"}),"Crear comandos")," - C\xf3mo crear los comandos con toda la informaci\xf3n necesaria."),Object(o.b)("li",{parentName:"ol"},Object(o.b)("a",r({parentName:"li"},{href:"#conclusi%C3%B3n"}),"Conclusi\xf3n")," - Resumen de todo sobre el administrador de comandos.")),Object(o.b)("h2",{id:"introducci\xf3n"},"Introducci\xf3n"),Object(o.b)("p",null,"Un administrador de comandos o ",Object(o.b)("em",{parentName:"p"},"command handler")," es aquel que por medio de archivos separados y manteniendo un orden, ejecuta siempre el mismo c\xf3digo el cual solamente busca el archivo y lo ejecuta como si de una librer\xeda o archivo externo se tratase."),Object(o.b)("hr",null),Object(o.b)("h2",{id:"administrar-comandos"},"Administrar comandos"),Object(o.b)("p",null,"Ya sabiendo qu\xe9 es un evento y los tipos de eventos, hacemos un evento que detecte los mensajes con lo siguiente:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),"public void onGuildMessageReceived(GuildMessageReceivedEvent e) {\n\n}\n")),Object(o.b)("p",null,"Ahora debemos verificar varias cosas:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Si el que envi\xf3 el mensaje es un bot"),",\nComprobamos esto porque puede ocurrir que alguien use un comando que repita lo del usuario y el bot responda, lo que puede ocacionar algo absurdo y la gente se confundir\xe1, lo mismo pasa si est\xe1 en el propio bot, porque lo repite."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Si el mensaje empieza con el prefijo del bot"),",\nExaminamos si el mensaje empieza con el prefijo del bot para ver si es un comando o no, esto sirve porque puede ser que el mensaje empiece por lo que sea y a\xfan as\xed lo detecta como comando.")),Object(o.b)("p",null,"Para eso, colocamos estas l\xedneas de c\xf3digo:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),'if (e.getMessage().getAuthor().isBot()) return;\nif (!e.getMessage().getContentRaw().startsWith("PREFIX")) return;\n')),Object(o.b)("p",null,"Reemplazamos obviamente ",Object(o.b)("inlineCode",{parentName:"p"},"PREFIX")," por el respectivo prefix del bot.\nAhora debemos establecer los argumentos de un comando, para eso se quitan las primeras letras del mensaje, es decir, el prefijo y se divide el mensaje por todos los espacios usando una expresi\xf3n regular (",Object(o.b)("em",{parentName:"p"},"RegEx"),") la cual es la siguiente: ",Object(o.b)("inlineCode",{parentName:"p"},'" +"'),". Todo esto escrito, ser\xeda lo siguiente:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),'String[] args = e.getMessage().getContentRaw().substring("PREFIX".length()).trim().split(" +");\n')),Object(o.b)("p",null,"Pero falta una cosa, quitar el primer elemento del array que ser\xeda el comando, pero todav\xeda no lo vamos a hacer. Vamos por partes: primero, verificamos si hay comando por medio de la lectura de la longitud de los argumentos, despu\xe9s se define el comando y por \xfaltimo, se redefinen los argumentos quitando el primero:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),"if (args.length < 1) return;\nString cmd = args[0].toLowerCase();\nargs = Arrays.copyOfRange(args, 1, args.length);\n")),Object(o.b)("p",null,"Ya por \xfaltimo, viene lo m\xe1s simple que ser\xeda ir a medida agregando varios ",Object(o.b)("inlineCode",{parentName:"p"},"if"),"s o un ",Object(o.b)("inlineCode",{parentName:"p"},"switch")," en el cual se ejecute un comando u otro. Podemos utilizar un simple ",Object(o.b)("inlineCode",{parentName:"p"},"switch")," de la siguiente manera:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),'switch (cmd) {\n  case "nombreComando":\n    comando.exec(e.getJDA(), e.getMessage(), args);\n    break;\n  case "otroComando":\n    otroCmd.exec(e.getJDA(), e.getMessage(), args);\n    break;\n}\n')),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},"\xa1Pero eso es todo por aqu\xed! En la secci\xf3n siguiente se muestra como crear el comando y de donde viene esa funci\xf3n de ejecuci\xf3n (",Object(o.b)("em",{parentName:"strong"},"exec"),") y cu\xe1les son los par\xe1metros.")),Object(o.b)("h2",{id:"crear-comandos"},"Crear comandos"),Object(o.b)("p",null,"Debemos crear un ",Object(o.b)("em",{parentName:"p"},"package")," llamado ",Object(o.b)("em",{parentName:"p"},"comandos"),", ",Object(o.b)("em",{parentName:"p"},"cmds"),", ",Object(o.b)("em",{parentName:"p"},"commands")," o de la manera que ustedes prefieran, donde ir\xe1n todos nuestros comandos que ser\xe1n una clase con una funci\xf3n de ejecuci\xf3n llamada ",Object(o.b)("em",{parentName:"p"},"exec")," y una visualizaci\xf3n de esto ser\xeda as\xed, con el comando de ",Object(o.b)("em",{parentName:"p"},"ping"),":"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),'package ejem.plo.cmds;\n\nimport net.dv8tion.jda.api.JDA;\nimport net.dv8tion.jda.api.entities.Message;\n\npublic class PingCommand {\n    public static void exec(JDA bot, Message msg, String[] args) {\n        msg.getChannel().sendMessage(String.format("Pong! %sms.", (int)bot.getGatewayPing())).queue();\n    }\n}\n')),Object(o.b)("p",null,"Como nos dimos cuenta en ese ejemplo, tenemos al bot, mensaje y sus argumentos en un ",Object(o.b)("em",{parentName:"p"},"Array")," de ",Object(o.b)("em",{parentName:"p"},"Strings")," (",Object(o.b)("em",{parentName:"p"},"String[]"),") y para enviar un mensaje se obtiene el canal y se crea el mensaje con la funci\xf3n de ",Object(o.b)("em",{parentName:"p"},"sendMessage")," y se agrega a la ",Object(o.b)("em",{parentName:"p"},"queue")," o lista de mensajes a enviar. Es decir, todo eso es:"),Object(o.b)("pre",null,Object(o.b)("code",r({parentName:"pre"},{className:"language-java"}),'msg.getChannel().sendMessage("Holaaa!").queue();\n// Se obtiene el canal de donde fue enviado el mensaje, se crea el mensaje a enviar y se coloca en la lista de los mensajes a enviar para ser enviado a continuaci\xf3n.\n')),Object(o.b)("hr",null),Object(o.b)("h2",{id:"conclusi\xf3n"},"Conclusi\xf3n"),Object(o.b)("p",null,"Aprendimos a crear un sistema de comandos detectando el comando, si es un bot no haga nada, si no empieza por el prefix no haga nada y sus argumentos, tambi\xe9n a exportar cosas de los diferentes comandos."))}l.isMDXComponent=!0},221:function(e,a,n){"use strict";n.d(a,"a",(function(){return c})),n.d(a,"b",(function(){return d}));var o=n(0),r=n.n(o),t=r.a.createContext({}),s=function(e){var a=r.a.useContext(t),n=a;return e&&(n="function"==typeof e?e(a):Object.assign({},a,e)),n},c=function(e){var a=s(e.components);return r.a.createElement(t.Provider,{value:a},e.children)};var i="mdxType",l={inlineCode:"code",wrapper:function(e){var a=e.children;return r.a.createElement(r.a.Fragment,{},a)}},m=Object(o.forwardRef)((function(e,a){var n=e.components,o=e.mdxType,t=e.originalType,c=e.parentName,i=function(e,a){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&-1===a.indexOf(o)&&(n[o]=e[o]);return n}(e,["components","mdxType","originalType","parentName"]),m=s(n),d=o,u=m[c+"."+d]||m[d]||l[d]||t;return n?r.a.createElement(u,Object.assign({},{ref:a},i,{components:n})):r.a.createElement(u,Object.assign({},{ref:a},i))}));function d(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var t=n.length,s=new Array(t);s[0]=m;var c={};for(var l in a)hasOwnProperty.call(a,l)&&(c[l]=a[l]);c.originalType=e,c[i]="string"==typeof e?e:o,s[1]=c;for(var d=2;d<t;d++)s[d]=n[d];return r.a.createElement.apply(null,s)}return r.a.createElement.apply(null,n)}m.displayName="MDXCreateElement"}}]);