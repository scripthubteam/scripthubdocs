(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{173:function(e,a,n){"use strict";n.r(a),n.d(a,"frontMatter",(function(){return r})),n.d(a,"rightToc",(function(){return s})),n.d(a,"default",(function(){return c}));n(51),n(24),n(19),n(20),n(52),n(0);var o=n(221);function t(){return(t=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var r={id:"djs-2",title:"Primeros pasos",sidebar_label:"Primeros pasos"},s=[{value:"Introducci\xf3n",id:"introducci\xf3n",children:[{value:"Requisitos",id:"requisitos",children:[]},{value:"Instalaci\xf3n",id:"instalaci\xf3n",children:[]}]},{value:"Primer bot",id:"primer-bot",children:[{value:"Discord Client",id:"discord-client",children:[]},{value:"Recibiendo mensajes",id:"recibiendo-mensajes",children:[]},{value:"Command Handler",id:"command-handler",children:[]}]},{value:"Archivo de Configuraci\xf3n",id:"archivo-de-configuraci\xf3n",children:[{value:"config.json",id:"configjson",children:[]},{value:"Utilizando config.json",id:"utilizando-configjson",children:[]}]},{value:"Conceptos",id:"conceptos",children:[{value:"Eventos",id:"eventos",children:[]},{value:"Colecciones",id:"colecciones",children:[]}]}],l={rightToc:s},i="wrapper";function c(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,o,t={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,["components"]);return Object(o.b)(i,t({},l,n,{components:a,mdxType:"MDXLayout"}),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},Object(o.b)("i",{class:"fas fa-download"})," ",Object(o.b)("a",t({parentName:"strong"},{href:"https://github.com/MrDevsaider/discordjs-bot-example"}),"Bot Modelo (discordjs-bot-example)")," (por ",Object(o.b)("a",t({parentName:"strong"},{href:"https://github.com/MrDevsaider"}),"MrDevsaider")," alojado en ",Object(o.b)("a",t({parentName:"strong"},{href:"https://github.com"}),"GitHub"),")"))),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Advertencia:")," Si no has le\xeddo el contenido de la gu\xeda, te recomendamos encarecidamente leerla antes de descargar el proyecto.")),Object(o.b)("h1",{id:"\xedndice"},"\xcdndice"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"#introducci%C3%B3n"}),"Introducci\xf3n")," - Introducci\xf3n de la librer\xeda ",Object(o.b)("inlineCode",{parentName:"li"},"discord.js")," y preparaci\xf3n del entorno de trabajo.\n",Object(o.b)("em",{parentName:"li"}," ",Object(o.b)("a",t({parentName:"em"},{href:"#requisitos"}),"Requisitos")," - Software necesario para empezar a utilizar ",Object(o.b)("inlineCode",{parentName:"em"},"discord.js"),".\n")," ",Object(o.b)("a",t({parentName:"li"},{href:"#instalacion"}),"Instalaci\xf3n")," - Instalaci\xf3n de la librer\xeda.\t"),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"#primer-bot"}),"Primer bot")," - Tutorial b\xe1sico para la creaci\xf3n de un bot.\n",Object(o.b)("em",{parentName:"li"}," ",Object(o.b)("a",t({parentName:"em"},{href:"#discord-client"}),"Discord Client")," - Poniendo en l\xednea el bot.\n")," ",Object(o.b)("a",t({parentName:"li"},{href:"#recibiendo-mensajes"}),"Recibiendo Mensajes")," - Recibiendo y enviando mensajes b\xe1sicos.\n* ",Object(o.b)("a",t({parentName:"li"},{href:"#command-handler"}),"Command Handler")," - A\xf1adiendo comandos y par\xe1metros."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"#archivo-de-configuraci%C3%B3n"}),"Archivo de Configuraci\xf3n")," - Utilizando un archivo externo para evitar exponer informaci\xf3n personal.\n",Object(o.b)("em",{parentName:"li"}," ",Object(o.b)("a",t({parentName:"em"},{href:"#config.json"}),"config.json")," - Creando .json para almacenar informaci\xf3n.\n")," ",Object(o.b)("a",t({parentName:"li"},{href:"#command-handler"}),"Utilizando config.json")," - Utilizando en el c\xf3digo la informaci\xf3n almacenada en config.json."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"#conceptos"}),"Conceptos")," - Explicaci\xf3n a fondo de algunas funciones de ",Object(o.b)("inlineCode",{parentName:"li"},"discord.js"),".\n",Object(o.b)("em",{parentName:"li"}," ",Object(o.b)("a",t({parentName:"em"},{href:"#eventos"}),"Eventos")," - Entendiendo el punto m\xe1s importante de ",Object(o.b)("inlineCode",{parentName:"em"},"discord.js"),".\n")," ",Object(o.b)("a",t({parentName:"li"},{href:"#colecciones"}),"Colecciones")," - Objetos hechos para almacenar varios elementos m\xe1s f\xe1cilmente.")),Object(o.b)("h2",{id:"introducci\xf3n"},"Introducci\xf3n"),Object(o.b)("p",null,Object(o.b)("a",t({parentName:"p"},{href:"https://github.com/discordjs/discord.js/",title:"Repositorio en GitHub de Discord.js"}),"Discord.js")," es una librer\xeda para ",Object(o.b)("a",t({parentName:"p"},{href:"https://nodejs.org/",title:"Web oficial de Node.js"}),"node.js")," hecha para facilitar el uso de ",Object(o.b)("a",t({parentName:"p"},{href:"https://discordapp.com/developers/docs/intro",title:"Discord API Documentation"}),"Discord API"),". "),Object(o.b)("p",null,"Fue desarrollada principalmente por ",Object(o.b)("a",t({parentName:"p"},{href:"https://github.com/hydrabolt",title:"Perfil en GitHub de hydrabolt"}),"hydrabolt")," y actualmente es la librer\xeda m\xe1s descargada en ",Object(o.b)("a",t({parentName:"p"},{href:"https://www.npmjs.com",title:"Web oficial de npm"}),"npm")," para la creaci\xf3n de bots en Discord."),Object(o.b)("p",null,"En el momento en que se escribe est\xe1 gu\xeda, su \xfaltima versi\xf3n es ",Object(o.b)("inlineCode",{parentName:"p"},"v11.3")," y ser\xe1 con la que estaremos trabajando. Cuenta con soporte para ES8 por lo que es posible utilizar ",Object(o.b)("inlineCode",{parentName:"p"},"async/await")," ",Object(o.b)("del",{parentName:"p"},"aunque estamos acostumbrados a las promesas"),"."),Object(o.b)("h3",{id:"requisitos"},"Requisitos"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"###node.js"}),"Node.js")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",t({parentName:"li"},{href:"###software-para-soporte-de-audio"}),"Software para soporte de audio"))),Object(o.b)("h4",{id:"nodejs"},"Node.js"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"Node.js")," es un entorno de ejecuci\xf3n, en este es posible ejecutar c\xf3digo escrito en ",Object(o.b)("inlineCode",{parentName:"p"},"JavaScript")," desde un servidor en lugar de un navegador."),Object(o.b)("p",null,"Para descargarlo, dir\xedjase al apartado de descargas en la ",Object(o.b)("a",t({parentName:"p"},{href:"https://nodejs.org/en/download/",title:"Descargar node.js"}),"web oficial")," y elija la versi\xf3n estable/recomendada ","(",Object(o.b)("inlineCode",{parentName:"p"},"8.11.1")," en el momento que se escribi\xf3 esta gu\xeda",")"),Object(o.b)("h5",{id:"npm"},"npm"),Object(o.b)("p",null,Object(o.b)("a",t({parentName:"p"},{href:"https://www.npmjs.com",title:"Web oficial de npm"}),Object(o.b)("inlineCode",{parentName:"a"},"NPM"))," es el servicio encargado de manejar los m\xf3dulos de Node.js desarrollados por la comunidad, consiste en un comando ","(","instalado junto con node",")"," que nos permite instalar y mantener actualizado cualquier m\xf3dulo alojado en su base de datos."),Object(o.b)("h4",{id:"software-para-soporte-de-audio"},"Software para soporte de audio"),Object(o.b)("p",null,"Si planea utilizar alguna funci\xf3n que requiera audio (reproducir m\xfasica en un canal de voz por ejemplo), necesitar\xe1 instalar algunos m\xf3dulos adicionales:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"En PowerShell con permisos de administrador:")),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"npm i -g --production windows-build-tools")))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("strong",{parentName:"p"},"En la carpeta que contendr\xe1 el bot:")),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"npm i ffmpeg-binaries")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"npm i node-opus")," (En caso de que ocurra alg\xfan error, intente con ",Object(o.b)("inlineCode",{parentName:"li"},"npm i opusscript"),")")))),Object(o.b)("h3",{id:"instalaci\xf3n"},"Instalaci\xf3n"),Object(o.b)("p",null,"Para empezar a utilizar ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js")," necesitar\xe1 crear una carpeta donde estar\xe1n ubicados los archivos necesarios para el funcionamiento del bot (o utilizar la carpeta en que haya instalado Opus y ffmpeg)."),Object(o.b)("p",null,"Luego de esto, deber\xe1 abrir el ",Object(o.b)("inlineCode",{parentName:"p"},"cmd")," ","(",'Win + R y escriba "cmd" en ejecutar',")"," y abrir\xe1 la ruta donde se encuentra la carpeta con el comando ",Object(o.b)("inlineCode",{parentName:"p"},"cd"),", ejemplo:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-console"}),"cd desktop/bot\n")),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Consejo:")," Tambi\xe9n puedes utilizar ",Object(o.b)("inlineCode",{parentName:"p"},"Shift + Click Derecho")," en la carpeta para abrir un cmd en ese directorio.  ")),Object(o.b)("p",null,"Hecho lo anterior, solo debe ejecutar el siguiente comando: ",Object(o.b)("inlineCode",{parentName:"p"},"npm i discord.js"),".\nDe esta manera, se empezar\xe1 a instalar ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js")," con todas sus dependencias en el directorio seleccionado."),Object(o.b)("p",null,"Si no hubo ning\xfan mensaje de error al finalizar la instalaci\xf3n, es hora de programar un bot."),Object(o.b)("h2",{id:"primer-bot"},"Primer bot"),Object(o.b)("p",null,"Una vez explicados los puntos b\xe1sicos y teniendo todo listo, podemos empezar a usar ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js"),", esta secci\xf3n cubrir\xe1 los primeros pasos en la creaci\xf3n de un bot (Respuestas, Command Handler y Argumentos)."),Object(o.b)("p",null,"Primero vamos a crear un nuevo archivo con extensi\xf3n ",Object(o.b)("inlineCode",{parentName:"p"},".js")," (ej: ",Object(o.b)("inlineCode",{parentName:"p"},"MejorBot.js"),")."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Importante:"),' en el Tipo de archivo al guardar debe elegir "Todos los archivos", de otra manera, es posible que se guarde como .txt.')),Object(o.b)("p",null,"Antes de nada, al igual que con cualquier otro m\xf3dulo de ",Object(o.b)("inlineCode",{parentName:"p"},"Node"),", se precisa de la funci\xf3n ",Object(o.b)("inlineCode",{parentName:"p"},"require()"),"para empezar a trabajar con \xe9l, as\xed que vamos a declarar una variable que contenga ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js"),"."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'const Discord = require("discord.js");\n')),Object(o.b)("h3",{id:"discord-client"},"Discord Client"),Object(o.b)("p",null,"La clase ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client",title:"Client"}),Object(o.b)("inlineCode",{parentName:"a"},"Client"))," es el principal punto de interacci\xf3n de ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js")," con ",Object(o.b)("inlineCode",{parentName:"p"},"Discord API"),", primero deber\xe1 crear una nueva instancia de ",Object(o.b)("inlineCode",{parentName:"p"},"Discord.Client")," e iniciar sesi\xf3n con el token obtenido en ",Object(o.b)("a",t({parentName:"p"},{href:"https://discordapp.com/developers/applications/me",title:"Discord Developers"}),"My apps"),"."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'const client = new Discord.Client();\n\nclient.login("TOKEN");\n')),Object(o.b)("p",null,"Luego para comprobar que todo haya salido bien, utilizaremos el evento ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client?scrollTo=e-ready",title:"Client#ready"}),Object(o.b)("inlineCode",{parentName:"a"},"ready")),", que es emitido en cuanto nuestro bot est\xe1 en l\xednea."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.on("ready", () => { \n    console.log("Conectado como " + client.user.tag); \n});\n')),Object(o.b)("p",null,"Luego ejecute el comando ",Object(o.b)("inlineCode",{parentName:"p"},"node")," seguido del nombre del archivo de su bot, ejemplo: "),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-console"}),"node bot.js\n")),Object(o.b)("p",null,'Si se imprime en la consola el mensaje "Conectado como ',Object(o.b)("inlineCode",{parentName:"p"},"DiscordTagDeNuestroBot"),'", todo sali\xf3 bien.'),Object(o.b)("h3",{id:"recibiendo-mensajes"},"Recibiendo mensajes"),Object(o.b)("p",null,"Ahora que nuestro bot est\xe1 en linea, comprobaremos su funcionamiento intentando que reciba y env\xede mensajes, para ello precisamos del evento ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client?scrollTo=e-message",title:"Client#message"}),Object(o.b)("inlineCode",{parentName:"a"},"message")),", este emitir\xe1 un ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Message",title:"Message"}),"objeto")," con todas las propiedades del mensaje (autor, contenido, canal)."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"client.on('message', message => { \n    console.log(messagr.author.tag, message.content);\n});\n")),Object(o.b)("p",null,"En este ejemplo, se estar\xeda imprimiendo en la consola el autor y contenido de cada mensaje que presencie el bot, si queremos que ignore el resto de mensajes exceptuando el que usted le indique, deber\xe1 crear una condici\xf3n que compare el contenido de los mensajes."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Importante:")," el siguiente ejemplo debe ubicarse dentro del evento ",Object(o.b)("inlineCode",{parentName:"p"},"message")," (al igual que todo lo que veremos a continuaci\xf3n) y no es la manera correcta para agregar comandos, m\xe1s adelante veremos como crear un command handler.")),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'if (message.content.startsWith("ping")) {\n    message.channel.send("Pong!");\n}\n')),Object(o.b)("p",null,"En este ejemplo, ",Object(o.b)("inlineCode",{parentName:"p"},"message.content")," representar\xeda el contenido del mensaje enviado, utilizando ",Object(o.b)("inlineCode",{parentName:"p"},"startsWith"),' comprobamos que el mensaje empiece por "ping", de esta manera, solo si se cumple esa condici\xf3n, enviar\xeda un mensaje que contenga "Pong".'),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Otra aclaratoria r\xe1pida y muy importante:")," ",Object(o.b)("inlineCode",{parentName:"p"},"message")," no es un m\xe9todo para enviar mensajes, es solo el objeto emitido por el evento, el m\xe9todo correcto ser\xeda ",Object(o.b)("inlineCode",{parentName:"p"},"send()"),", que solo funciona sobre un canal de texto, en este caso ",Object(o.b)("inlineCode",{parentName:"p"},"message.channel")," que ser\xeda el canal en el que fue enviado el mensaje.")),Object(o.b)("h3",{id:"command-handler"},"Command Handler"),Object(o.b)("p",null,"Es hora de darle forma a nuestro bot y empezar a a\xf1adir comandos. En el ejemplo de la secci\xf3n anterior pudimos hacer que nuestro bot reaccione a los mensajes que le indiquemos, pero esto no es suficiente, se precisa de algo que filtre los mensajes de una manera m\xe1s c\xf3moda y tome los par\xe1metros adicionales que le indique el usuario (argumentos)."),Object(o.b)("p",null,"Primero que nada elija un prefijo, algo \xfanico que diferencie los comandos de su bot y nos ocuparemos de que solo responda a los comandos que comiencen por este."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'const prefix = "/";\n\nif (!message.content.startsWith(prefix)) return;\n')),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"No usen ",Object(o.b)("inlineCode",{parentName:"p"},"/")," de prefijo, es solo un ejemplo.")),Object(o.b)("h4",{id:"argumentos"},"Argumentos"),Object(o.b)("p",null,"Una vez hecho lo anterior, para terminar el Command Handler debemos hacer dos cosas:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Eliminar el prefijo dejando solo el comando."),Object(o.b)("li",{parentName:"ul"},"Tomar el resto del contenido del mensaje como argumentos.")),Object(o.b)("p",null,"\xbfSuena complicado?, perm\xedtanme decir que no lo es, vamos a declarar otras tres variables y proceder\xe9 a explicar el funcionamiento de estas."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'const args = message.content.slice(prefix.length).trim().split(/ +/g);\nconst command = args.shift().toLowerCase();\nconst content = args.join(" ");\n')),Object(o.b)("p",null,"Supongamos que tenemos el siguiente comando: ",Object(o.b)("inlineCode",{parentName:"p"},"/saludo Me llamo Nakido")),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"En la primera variable (",Object(o.b)("inlineCode",{parentName:"li"},"args"),"), obviamente lo primero que hacemos es tomar el contenido del mensaje.\n",Object(o.b)("em",{parentName:"li"}," Con ",Object(o.b)("inlineCode",{parentName:"em"},"slice()")," estamos cortando del mensaje nuestro prefijo, si nuestro prefijo es ",Object(o.b)("inlineCode",{parentName:"em"},"/"),", un prefijo de solo un caracter, ",Object(o.b)("inlineCode",{parentName:"em"},"prefix.length")," solo ser\xeda ",Object(o.b)("inlineCode",{parentName:"em"},"1"),", por lo tanto el comando pasar\xeda a ser solo ",Object(o.b)("inlineCode",{parentName:"em"},"saludo"))," ",Object(o.b)("inlineCode",{parentName:"li"},"trim()")," elimina todos los espacios adicionales que puedan haber antes y despu\xe9s del mensaje.\n* ",Object(o.b)("inlineCode",{parentName:"li"},"split(/ +/g)")," separar\xeda el mensaje por sus espacios dejando solo un array (utilizamos RegExp en lugar de solo un espacio en caso de que haya un espacio adicional entre palabras, error muy com\xfan en los que acostumbramos a usar Discord en celular), de esta manera nos quedar\xeda ",Object(o.b)("inlineCode",{parentName:"li"},'["saludo", "Me", "llamo", Nakido]')),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"command")," ser\xeda lo que usaremos luego para agregar comandos.\n",Object(o.b)("em",{parentName:"li"}," ",Object(o.b)("inlineCode",{parentName:"em"},"args.shift()")," separar\xeda el comando del resto del mensaje (",Object(o.b)("inlineCode",{parentName:"em"},"shift()")," remueve el primer objeto de un array), de esta manera ",Object(o.b)("inlineCode",{parentName:"em"},"args")," solo quedar\xeda como el resto del contenido del mensaje (",Object(o.b)("inlineCode",{parentName:"em"},'["Me", "llamo", Nakido]'),") y lo podremos utilizar para definir par\xe1metros adicionales en nuestros comandos.\n"),"  ",Object(o.b)("inlineCode",{parentName:"li"},"toLowerCase()")," har\xeda que todo el comando estuviera en min\xfasculas, as\xed en caso de que nos equivoquemos escribiendo el comando y pongamos algo como ",Object(o.b)("inlineCode",{parentName:"li"},"/Saludo"),", funcionar\xeda igual."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("inlineCode",{parentName:"li"},"content")," ser\xeda similar a ",Object(o.b)("inlineCode",{parentName:"li"},"args"),", solo que en lugar de tener un array, ser\xeda un string.\n* ",Object(o.b)("inlineCode",{parentName:"li"},'join(" ")')," es la funci\xf3n que se encarga de unir todos los elementos del array con espacios en un string.")),Object(o.b)("h4",{id:"comandos"},"Comandos"),Object(o.b)("p",null,"Habiendo entendido todo, prosigamos a hacer un comando."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'if (command === "ping") {\n    message.channel.send("Pong!");\n}\n')),Object(o.b)("p",null,"M\xe1s simple eh?, de esta manera no tendr\xe1n los problemas de ",Object(o.b)("inlineCode",{parentName:"p"},"startsWith()"),' (anteriormente, s\xed pon\xedamos cosas como "pingdasdlkh", el mensaje se enviaba igual ya que la condici\xf3n detectaba que empieza por "ping").'),Object(o.b)("p",null,"Ahora aprovechemos las otras dos variables y hagamos algo m\xe1s interesante."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'if (command === "say") {\n    message.channel.send(content);\n}\n')),Object(o.b)("p",null,"Con este comando, si utiliz\xe1ramos ",Object(o.b)("inlineCode",{parentName:"p"},"/say Soy el mejor"),', el bot enviar\xeda un mensaje diciendo "Soy el mejor".'),Object(o.b)("p",null,"Ahora intentemos algo m\xe1s complicado."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'if (command === "presentacion") {\n    const nombre = args[0];\n    const edad = args[1];\n    const pais = args[2];\n        message.channel.send("Hola, mi nombre es " + nombre + ", tengo " + edad + " a\xf1os y actualmente vivo en " + pais);\n}\n// Desestructuraci\xf3n de arrays en ES6\nif (command === "presentacion") {\n    const [nombre, edad, pais] = args;\n        message.channel.send("Hola, mi nombre es " + nombre + ", tengo " + edad + " a\xf1os y actualmente vivo en " + pais);\n}\n')),Object(o.b)("p",null,"Si utilizamos el comando de la siguiente manera: ",Object(o.b)("inlineCode",{parentName:"p"},"/presentacion Daniel 22 Venezuela"),', el bot enviar\xeda "Hola, mi nombre es Daniel, tengo 22 a\xf1os y actualmente vivo en Venezuela".'),Object(o.b)("p",null,"Bastante \xfatil, pero ahora te toca a ti crear tus propios comandos."),Object(o.b)("h4",{id:"notas-adicionales"},"Notas adicionales"),Object(o.b)("p",null,"Puedes crear tus propios mensajes de error si tu comando no encuentra algo que especificaste, como los argumentos, un ejemplo que puedes a\xf1adir al comienzo de un comando para que el usuario deba escribirlo:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'if (!args) return message.channel.send("Introduzca algunos par\xe1metros");\n')),Object(o.b)("p",null,"Tambi\xe9n recomiendo ignorar los mensajes de los bots, si interact\xfaan entre ellos podr\xeda ocurrir un desastre (",Object(o.b)("del",{parentName:"p"},"temo que puedan querer apoderase de nuestros servidores"),"), para evitarlo solo a\xf1ada la siguiente condici\xf3n al comienzo del evento ",Object(o.b)("inlineCode",{parentName:"p"},"message"),":"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"if (message.author.bot) return;\n")),Object(o.b)("p",null,"Si queremos tomar una menci\xf3n, iremos al objeto que las contiene ",Object(o.b)("inlineCode",{parentName:"p"},"message.mentions.users")," y agarraremos la primera con ",Object(o.b)("inlineCode",{parentName:"p"},"first()")),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"console.log(message.mentions.users.first().tag);\n")),Object(o.b)("p",null,"Otra cosa que quiero mencionar es que son los punto y coma (",Object(o.b)("inlineCode",{parentName:"p"},";"),") que utilizo en cada ejemplo ",Object(o.b)("strong",{parentName:"p"},"no son necesarios"),", los utilizo por mantener un orden al final de cada declaraci\xf3n."),Object(o.b)("h2",{id:"archivo-de-configuraci\xf3n"},"Archivo de Configuraci\xf3n"),Object(o.b)("p",null,"Puede que quieras ense\xf1arle tu c\xf3digo a alguien o subirlo a un repositorio en GitHub, pero este contiene el token de tu bot, alguna API key o cuenta personal, para evitar exponer esta informaci\xf3n y ya de paso poder acceder a esta m\xe1s f\xe1cilmente, podemos utilizar un archivo de configuraci\xf3n."),Object(o.b)("h3",{id:"configjson"},"config.json"),Object(o.b)("p",null,"Lo primero que har\xe1, ser\xe1 crear un archivo en la carpeta de nuestro bot y le colocamos el nombre ",Object(o.b)("inlineCode",{parentName:"p"},"config.json"),"(no necesariamente debe ser ese nombre, pero la extensi\xf3n s\xed debe ser .json)."),Object(o.b)("p",null,"El contenido del archivo debe ser similar al siguiente:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-json"}),'{\n    "prefix": "/",\n    "token": "MzI2ODA5NA6hE5h75NzByNjQx.DAkbDQ.kF7Jf66X2z4KR31yRQ58PYvy4Y",\n    "ownerID": "159158446304788481"\n}\n')),Object(o.b)("p",null,"Posteriormente, seguramente necesiten a\xf1adir m\xe1s datos, mi archivo de configuraci\xf3n es mas o menos as\xed:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-json"}),'{\n  "token":"NDQxMjgzMDUxMTM0Mzg2gkH_eyX1joM",\n  "prefix": ".",\n  "APIkeys": {\n    "yandex": "022T04676edde956323dd922",\n    "osu": "413a4c89d96f5e4453e466"\n  },\n  "mal": {\n    "user": "Nakido", \n    "pass": "passchida"\n  }\n}\n')),Object(o.b)("h3",{id:"utilizando-configjson"},"Utilizando config.json"),Object(o.b)("p",null,"El config.json lo utilizaremos con un ",Object(o.b)("inlineCode",{parentName:"p"},"require()")," de la siguiente manera:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'const { prefix, token } = require("./config.json");\n')),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Importante:")," el ",Object(o.b)("inlineCode",{parentName:"p"},"./")," para que detecte que est\xe1 en un directorio y no es un m\xf3dulo.")),Object(o.b)("p",null,"Y luego solo queda implementarlo en el c\xf3digo"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"client.login(token);\n")),Object(o.b)("h2",{id:"conceptos"},"Conceptos"),Object(o.b)("p",null,"Puntos de ",Object(o.b)("inlineCode",{parentName:"p"},"discord.js")," que pueden resultar m\xe1s complicados de entender y/o dominar en su totalidad."),Object(o.b)("h3",{id:"eventos"},"Eventos"),Object(o.b)("p",null,'Los eventos son el principal punto de interacci\xf3n con nuestro bot, cada vez que "ocurre algo" en Discord mientras nuestro bot est\xe1 presente (Como enviar un mensaje, crear un canal, etc), ',Object(o.b)("inlineCode",{parentName:"p"},"discord.js")," emitir\xe1 un evento."),Object(o.b)("p",null,"Para controlar estos eventos, utilizaremos ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client",title:"Client"}),Object(o.b)("inlineCode",{parentName:"a"},"Client")),"."),Object(o.b)("p",null,"La s\xedntaxis b\xe1sica de cada evento ser\xeda:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.on("NombreDelEvento", (par\xe1metros) => {\n    //C\xf3digo a ejecutarse cuando se emita el evento\n});\n')),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Obviamente, si quieres usar esos par\xe1metros debes utilizarlos dentro del evento, si la consola te da un error diciendo ",Object(o.b)("inlineCode",{parentName:"p"},"message is not defined")," ya sabes porqu\xe9 es.")),Object(o.b)("p",null,"Al ejecutarse un evento, los par\xe1metros pasar\xedan a ser el objeto que emita el evento, si por ejemplo, fuese el ya visto evento ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client?scrollTo=e-message",title:"Client#message"}),Object(o.b)("inlineCode",{parentName:"a"},"message")),", este objeto contendr\xeda todo los datos del mensaje que haya ejectuado el evento (Contenido, ID, Autor, Canal)."),Object(o.b)("p",null,"Un ejemplo con el evento ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client?scrollTo=e-message",title:"Client#messageUpdate"}),Object(o.b)("inlineCode",{parentName:"a"},"messageUpdate"))," (Emitido cuando se edita un mensaje o se a\xf1ade un embed):"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.on("messageUpdate", (oldmsg, newmsg) => {\n    let canal = oldmsg.channel; \n    if(canal !== "198291975663779842") return; //Ignora los mensajes de otros canales\n        canal.send(oldmsg.content, newmsg.content);\n})\n')),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},Object(o.b)("strong",{parentName:"p"},"Importante:")," Los eventos son emitido en TODOS los servidores en que est\xe9 tu bot, por eso la tercera l\xednea que ignora todos los canales menos el indicado.")),Object(o.b)("p",null,"Para m\xe1s informaci\xf3n y una lista con todos los eventos, dir\xedganse al apartado ",Object(o.b)("strong",{parentName:"p"},"Events")," en la documentaci\xf3n de la clase ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Client"}),Object(o.b)("inlineCode",{parentName:"a"},"Client")),"."),Object(o.b)("h4",{id:"evento-ready"},"Evento ",Object(o.b)("inlineCode",{parentName:"h4"},"ready")),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.user.setActivity("Dando amor en " + client.guilds.size + "servidores")\n\nclient.on("ready", () => {\n    client.user.setActivity("Dando amor en " + client.guilds.size + "servidores");\n});\n')),Object(o.b)("p",null,"\xbfCual es la diferencia entre el setActivity que est\xe1 dentro del evento ",Object(o.b)("inlineCode",{parentName:"p"},"ready")," y el que est\xe1 fuera?"),Object(o.b)("p",null,"El de fuera nos dar\xe1 ",Object(o.b)("inlineCode",{parentName:"p"},"undefined"),"."),Object(o.b)("p",null,"Esto se debe a que al momento de ejecutar el c\xf3digo, ",Object(o.b)("inlineCode",{parentName:"p"},"client")," no est\xe1 disponible debido a que demora un poco en cargar toda la informaci\xf3n del bot (servidores, usuarios, etc), por lo tanto cualquier cosa que quieras ejecutar al encender el bot, debe estar dentro del evento ",Object(o.b)("inlineCode",{parentName:"p"},"ready"),"."),Object(o.b)("h4",{id:"probando-eventos"},"Probando eventos"),Object(o.b)("p",null,'Supongamos que estamos haciendo un sistema de bienvenidas y queremos probarlo, lo primero que se te vendr\xe1 a la cabeza seguramente sea entrar y salir constantemente con una multicuenta, pero esto es bastante molesto y pesado, en su lugar podemos "simular" un evento con ',Object(o.b)("inlineCode",{parentName:"p"},"emit()"),"."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.emit("guildMemberAdd", message.member);\n')),Object(o.b)("p",null,'Como puedes observar, es una funci\xf3n, el primer par\xe1metro debe ser el nombre del evento y el segundo, ser\xeda el objeto que emitir\xeda el evento, pero en este caso debemos declararlo nosotros, en el ejemplo anterior, estoy tomando al autor del mensaje como ese usuario que "entr\xf3".'),Object(o.b)("h3",{id:"colecciones"},"Colecciones"),Object(o.b)("p",null,"Cuando una propiedad posee varios objetos similares (como canales), son almacenados de una manera diferente para poder acceder a ellos m\xe1s f\xe1cilmente, estas son las colecciones, un ejemplo de una colecci\xf3n ser\xeda ",Object(o.b)("inlineCode",{parentName:"p"},"guild.channels"),", esta contendr\xeda todos los canales de un servidor."),Object(o.b)("p",null,"Las colecciones utilizan la misma estrectura de los objetos ",Object(o.b)("inlineCode",{parentName:"p"},"Map()")," ya implementados por defecto en JavaScript pero con algunas funciones adicionales que nos permiten trabajar con ellas de una manera m\xe1s simple y amplia que, lo que podr\xeda ser un array."),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Estar\xe9 explicando todo dentro del evento ",Object(o.b)("inlineCode",{parentName:"p"},"message")," con el fin de hacer todo m\xe1s f\xe1cil de entender.")),Object(o.b)("h4",{id:"convirtiendo-en-un-array"},"Convirtiendo en un array"),Object(o.b)("p",null,"\xbfNo te gusta la estructura de las colecciones?, no pasa nada, existe el m\xe9todo ",Object(o.b)("inlineCode",{parentName:"p"},".array()")," que nos devolver\xeda un nuevo array con todo lo que contiene una colecci\xf3n, ejemplo:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"const canal = message.guild.channels.array()[0];\nconst nombre = canal.name;\n")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"nombre")," devolver\xeda el nombre del primer canal (en cuanto a posici\xf3n) del servidor, aunque s\xed queremos el primer canal, existe un m\xe9todo m\xe1s simple."),Object(o.b)("h4",{id:"primero-y-\xfaltimo"},"Primero y \xfaltimo"),Object(o.b)("p",null,"Est\xe1n los m\xe9todos ",Object(o.b)("inlineCode",{parentName:"p"},"first()")," y ",Object(o.b)("inlineCode",{parentName:"p"},"last()")," para las colecciones, permiti\xe9ndonos acceder m\xe1s f\xe1cilmente al primer y \xfaltimo elemento de la colecci\xf3n."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"const canales = message.guild.channels;\nconst primero = canales.first();\nconst ultimo = canales.last();\n")),Object(o.b)("p",null,"Incluso podemos incluir un par\xe1metro para tomar varios elementos."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"canales.first(2)\n")),Object(o.b)("p",null,"Tomar\xeda los primeros dos, no hace falta explicar m\xe1s."),Object(o.b)("h4",{id:"mapeo"},"Mapeo"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"map()")," es uno de los m\xe9todos m\xe1s \xfatiles para colecciones, es igual que la funci\xf3n ",Object(o.b)("a",t({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map",title:"MDN web docs"}),Object(o.b)("inlineCode",{parentName:"a"},"Array.map()")),", devuelve un array basado en la funci\xf3n indicada."),Object(o.b)("p",null,"Supongamos que queremos todos los nombres de los usuarios de un servidor, har\xedamos lo siguiente:"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"const usuarios = message.guild.members;\nconst nombres = usuarios.map(u => u.displayName);\n")),Object(o.b)("p",null,"Tambi\xe9n hay que tener en cuenta que la funci\xf3n dentro del ",Object(o.b)("inlineCode",{parentName:"p"},"map()")," se ejecuta por cada elemento y puede ser m\xe1s de una."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"usuarios.map(u => {\n    message.channel.send(u.displayName);\n    message.channel.send(u.id);\n});\n")),Object(o.b)("p",null,"Esto enviar\xeda el id y nombre de todos los usuarios de un servidor, uno por mensaje ya que se est\xe1 ejecutando por cada usuario."),Object(o.b)("h4",{id:"filtrar"},"Filtrar"),Object(o.b)("p",null,"Es posible filtrar los elementos bajo la condici\xf3n indicada utilizando ",Object(o.b)("inlineCode",{parentName:"p"},"filter()")," (Similar a ",Object(o.b)("a",t({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter",title:"MDN web docs"}),Object(o.b)("inlineCode",{parentName:"a"},"Array.filter()")),"). "),Object(o.b)("p",null,"En lugar de un array como ",Object(o.b)("inlineCode",{parentName:"p"},"map()"),", este devuelve una nueva colecci\xf3n."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"message.guild.members.filter(g => g.nickname);\n")),Object(o.b)("p",null,"Esto ser\xeda una colecci\xf3n con todos los usuarios que tienen nick, ahora intentemos utilizar ",Object(o.b)("inlineCode",{parentName:"p"},"map()")," ya que s\xed, se pueden utilizar entre s\xed mientras se obtenga otra colecci\xf3n."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"message.guild.members.filter(g => g.nickname).map(u => {\n    message.channel.send(u.id);\n}\n")),Object(o.b)("h4",{id:"b\xfasqueda"},"B\xfasqueda"),Object(o.b)("p",null,"Ahora los dos m\xe9todos que nos permiten buscar algo espec\xedfico entre colecciones: ",Object(o.b)("inlineCode",{parentName:"p"},"get()")," y ",Object(o.b)("inlineCode",{parentName:"p"},"find()"),"."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"get()")," es un m\xe9todo para ",Object(o.b)("inlineCode",{parentName:"p"},"map()"),", pero podemos utilizarlo en las colecciones para buscar un elemento espec\xedfico, en este caso, por id."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'client.users.get("163156330721443840");\n')),Object(o.b)("p",null,"Con esto obtendriamos la colecci\xf3n del usuario que posea esa id ",Object(o.b)("del",{parentName:"p"},"es mi amigo btw, vayan a spammearle fotos de gatitos"),"."),Object(o.b)("p",null,"Luego tenemos ",Object(o.b)("inlineCode",{parentName:"p"},"find()")," que al igual que ",Object(o.b)("a",t({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find",title:"MDN web docs"}),Object(o.b)("inlineCode",{parentName:"a"},"Array.find()")),", podemos utilizarlo para buscar un valor entre todos los elementos de la colecci\xf3n, como el nombre de un canal o usuario."),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),'message.guild.channels.find("name", "Nakido");\n')),Object(o.b)("p",null,"Esta funci\xf3n utiliza dos par\xe1metros, el primero es la propiedad que buscamos, y el segundo lo que deber\xeda contener."),Object(o.b)("h4",{id:"otros-m\xe9todos"},"Otros m\xe9todos"),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},".concat()")," funciona para combinar una colecci\xf3n con otra/s"),Object(o.b)("pre",null,Object(o.b)("code",t({parentName:"pre"},{className:"language-js"}),"const servidor = message.guild;\nconst unaColeccion = servidor.channels;\nconst otraColeccion = servidor.members;\nconst ultimaColeccion = servidor.roles;\n\nunaColeccion.concat(otraColeccion, ultimaColeccion);\n")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},".findAll()")," similar a ",Object(o.b)("inlineCode",{parentName:"p"},".find()")," solo que este devuelve todos los elementos que coincidan con la b\xfasqueda en lugar de solo uno."),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},".random()")," devolver\xeda un elemento aleatorio de la colecci\xf3n."),Object(o.b)("p",null,"Para ver todos los m\xe9todos y m\xe1s informaci\xf3n, entra en la documentaci\xf3n de ",Object(o.b)("a",t({parentName:"p"},{href:"https://discord.js.org/#/docs/main/stable/class/Collection",title:"Collection"}),"Discord.js")," y ",Object(o.b)("a",t({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",title:"Map"}),"MDN"),"."))}c.isMDXComponent=!0},221:function(e,a,n){"use strict";n.d(a,"a",(function(){return l})),n.d(a,"b",(function(){return d}));var o=n(0),t=n.n(o),r=t.a.createContext({}),s=function(e){var a=t.a.useContext(r),n=a;return e&&(n="function"==typeof e?e(a):Object.assign({},a,e)),n},l=function(e){var a=s(e.components);return t.a.createElement(r.Provider,{value:a},e.children)};var i="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return t.a.createElement(t.a.Fragment,{},a)}},b=Object(o.forwardRef)((function(e,a){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,i=function(e,a){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&-1===a.indexOf(o)&&(n[o]=e[o]);return n}(e,["components","mdxType","originalType","parentName"]),b=s(n),d=o,p=b[l+"."+d]||b[d]||c[d]||r;return n?t.a.createElement(p,Object.assign({},{ref:a},i,{components:n})):t.a.createElement(p,Object.assign({},{ref:a},i))}));function d(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=b;var l={};for(var c in a)hasOwnProperty.call(a,c)&&(l[c]=a[c]);l.originalType=e,l[i]="string"==typeof e?e:o,s[1]=l;for(var d=2;d<r;d++)s[d]=n[d];return t.a.createElement.apply(null,s)}return t.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"}}]);